
meeting_worker      | [NeMo I 2025-10-02 16:49:17 nemo_logging:393] PADDING: 16
meeting_worker      | [NeMo I 2025-10-02 16:49:18 nemo_logging:393] Model EncDecSpeakerLabelModel was successfully restored from /project/diarization_service/models/rimecaster.nemo.
meeting_worker      | [2025-10-02 16:49:18,092: INFO/MainProcess] Speaker Embedding model '/project/diarization_service/models/rimecaster.nemo' loaded successfully.
meeting_worker      | [2025-10-02 16:49:18,092: INFO/MainProcess] Connecting to Qdrant at 10.43.128.107:7333...
meeting_worker      | [2025-10-02 16:49:18,254: WARNING/MainProcess] Qdrant collection 'meeting_speakers' not found. Creating it now.
meeting_worker      | [2025-10-02 16:49:18,256: ERROR/MainProcess] Signal handler <function on_worker_init at 0x7fb8cf317600> raised: ResponseHandlingException(ConnectError('[Errno 111] Connection refused'))
meeting_worker      | Traceback (most recent call last):
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
meeting_worker      |     yield
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/httpx/_transports/default.py", line 250, in handle_request
meeting_worker      |     resp = self._pool.handle_request(req)
meeting_worker      |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/httpcore/_sync/connection_pool.py", line 256, in handle_request
meeting_worker      |     raise exc from None
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/httpcore/_sync/connection_pool.py", line 236, in handle_request
meeting_worker      |     response = connection.handle_request(
meeting_worker      |                ^^^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/httpcore/_sync/connection.py", line 101, in handle_request
meeting_worker      |     raise exc
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/httpcore/_sync/connection.py", line 78, in handle_request
meeting_worker      |     stream = self._connect(request)
meeting_worker      |              ^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/httpcore/_sync/connection.py", line 124, in _connect
meeting_worker      |     stream = self._network_backend.connect_tcp(**kwargs)
meeting_worker      |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/httpcore/_backends/sync.py", line 207, in connect_tcp
meeting_worker      |     with map_exceptions(exc_map):
meeting_worker      |          ^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
meeting_worker      |     self.gen.throw(value)
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/httpcore/_exceptions.py", line 14, in map_exceptions
meeting_worker      |     raise to_exc(exc) from exc
meeting_worker      | httpcore.ConnectError: [Errno 111] Connection refused
meeting_worker      |
meeting_worker      | The above exception was the direct cause of the following exception:
meeting_worker      |
meeting_worker      | Traceback (most recent call last):
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/qdrant_client/http/api_client.py", line 134, in send_inner
meeting_worker      |     response = self._client.send(request)
meeting_worker      |                ^^^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/httpx/_client.py", line 914, in send
meeting_worker      |     response = self._send_handling_auth(
meeting_worker      |                ^^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/httpx/_client.py", line 942, in _send_handling_auth
meeting_worker      |     response = self._send_handling_redirects(
meeting_worker      |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/httpx/_client.py", line 979, in _send_handling_redirects
meeting_worker      |     response = self._send_single_request(request)
meeting_worker      |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/httpx/_client.py", line 1014, in _send_single_request
meeting_worker      |     response = transport.handle_request(request)
meeting_worker      |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/httpx/_transports/default.py", line 249, in handle_request
meeting_worker      |     with map_httpcore_exceptions():
meeting_worker      |          ^^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
meeting_worker      |     self.gen.throw(value)
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
meeting_worker      |     raise mapped_exc(message) from exc
meeting_worker      | httpx.ConnectError: [Errno 111] Connection refused
meeting_worker      |
meeting_worker      | During handling of the above exception, another exception occurred:
meeting_worker      |
meeting_worker      | Traceback (most recent call last):
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/celery/utils/dispatch/signal.py", line 280, in send
meeting_worker      |     response = receiver(signal=self, sender=sender, **named)
meeting_worker      |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/code/app/worker/tasks.py", line 34, in on_worker_init
meeting_worker      |     _enrollment_service = SpeakerEnrollment()
meeting_worker      |                           ^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/code/app/processing/enrollment.py", line 84, in __init__
meeting_worker      |     self._ensure_qdrant_collection()
meeting_worker      |   File "/code/app/processing/enrollment.py", line 100, in _ensure_qdrant_collection
meeting_worker      |     self.qdrant_client.recreate_collection(
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/qdrant_client/qdrant_client.py", line 2479, in recreate_collection
meeting_worker      |     return self._client.recreate_collection(
meeting_worker      |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/qdrant_client/qdrant_remote.py", line 2843, in recreate_collection
meeting_worker      |     self.delete_collection(collection_name, timeout=timeout)
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/qdrant_client/qdrant_remote.py", line 2697, in delete_collection
meeting_worker      |     result: Optional[bool] = self.http.collections_api.delete_collection(
meeting_worker      |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/qdrant_client/http/api/collections_api.py", line 308, in delete_collection
meeting_worker      |     return self._build_for_delete_collection(
meeting_worker      |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/qdrant_client/http/api/collections_api.py", line 123, in _build_for_delete_collection
meeting_worker      |     return self.api_client.request(
meeting_worker      |            ^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/qdrant_client/http/api_client.py", line 95, in request
meeting_worker      |     return self.send(request, type_)
meeting_worker      |            ^^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/qdrant_client/http/api_client.py", line 112, in send
meeting_worker      |     response = self.middleware(request, self.send_inner)
meeting_worker      |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/qdrant_client/http/api_client.py", line 250, in __call__
meeting_worker      |     return call_next(request)
meeting_worker      |            ^^^^^^^^^^^^^^^^^^
meeting_worker      |   File "/usr/local/lib/python3.12/dist-packages/qdrant_client/http/api_client.py", line 136, in send_inner
meeting_worker      |     raise ResponseHandlingException(e)
meeting_worker      | qdrant_client.http.exceptions.ResponseHandlingException: [Errno 111] Connection refused
